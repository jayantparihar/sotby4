{"ast":null,"code":"import _slicedToArray from \"/home/azureuser/sotby2.0/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _toConsumableArray from \"/home/azureuser/sotby2.0/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _objectSpread from \"/home/azureuser/sotby2.0/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"/home/azureuser/sotby2.0/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/azureuser/sotby2.0/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/azureuser/sotby2.0/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/azureuser/sotby2.0/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/azureuser/sotby2.0/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/azureuser/sotby2.0/app/src/components/NoCollision_Week.jsx\";\nimport React from \"react\";\nimport _ from \"lodash\";\nimport TimelineGridWeek from \"./TimelineGrid_Week\";\n// import {  } from \"@reach/router\";\nimport { ReactSession } from 'react-client-session';\nimport RGL, { WidthProvider } from \"react-grid-layout\";\nimport { Link, Navigate } from 'react-router-dom';\nvar LocalStorageLayout = /*#__PURE__*/function (_React$PureComponent) {\n  _inherits(LocalStorageLayout, _React$PureComponent);\n  //###############################################################################\n  // ---------DISCLAMER: THIS WILL BE PAINFUL TO LOOK AT. IM SORRY :(.  -love matt\n  //############################################################################### \n\n  function LocalStorageLayout(_ref) {\n    var _this;\n    var props = _ref.props,\n      socket = _ref.socket,\n      heightLimit = _ref.heightLimit,\n      newInstructorArray = _ref.newInstructorArray,\n      weekInformation = _ref.weekInformation,\n      totalWeeks = _ref.totalWeeks,\n      currentWeekDays = _ref.currentWeekDays,\n      currentWeek = _ref.currentWeek,\n      currentDate = _ref.currentDate,\n      firstDate = _ref.firstDate;\n    _classCallCheck(this, LocalStorageLayout);\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(LocalStorageLayout).call(this, props));\n\n    // let timeLineInformation = weekInformation.weekRangesArray[currentMonth];\n    _this.replaceItem = function (item) {\n      for (var i = 0; i < _this.state.items.length; i++) {\n        if (_this.state.items.i === item.i) {\n          var newLayout = _this.state.items.slice();\n          newLayout[i] = item;\n          _this.setState({\n            items: newLayout\n          });\n          break;\n        }\n      }\n    };\n    _this.onLayoutChange = function (layoutWeek) {\n      _this.setState({\n        layoutWeek: layoutWeek\n      });\n    };\n    _this.onItemChange = function (oldItem, newItem, instructorKey) {\n      // Update the dates on the postgresql data\n\n      var startDate = findWeekDateFromIndex(newItem.x, _this.props.currentDate, _this.props.firstDate);\n      var endDate = findWeekDateFromIndex(newItem.w + newItem.x - 1, _this.props.currentDate, _this.props.firstDate);\n\n      // HTTP request instead of sockets\n      var index = _.findIndex(_this.allWeekItems[instructorKey], function (element) {\n        return element.data.i.toString() === newItem.i;\n      });\n      var foundItem = _this.allWeekItems[instructorKey][index];\n\n      // this.allWeekItems[instructorKey][index] = newItem\n\n      // Restrict movement of the course to two rows only\n      var yAxisLockedItem = newItem;\n      if (oldItem.y !== 2) {\n        if (newItem.y < oldItem.y + 2 && newItem.y > oldItem.y - 2) {\n          if ((newItem.y + 1) % 3 !== 0) {\n            _this.replaceItem(yAxisLockedItem);\n          } else {\n            yAxisLockedItem.y = oldItem.y;\n            _this.replaceItem(yAxisLockedItem);\n          }\n        } else {\n          yAxisLockedItem.y = oldItem.y;\n          _this.replaceItem(yAxisLockedItem);\n        }\n        if (yAxisLockedItem.y !== oldItem.y) {\n          _this.socket.emit('itemChanged', yAxisLockedItem, {\n            username: instructorKey,\n            courseNum: foundItem.courseNum,\n            caId: foundItem.caId,\n            start: startDate.getTime(),\n            end: endDate.getTime(),\n            m_or_a: newItem.y\n          });\n        } else {\n          _this.socket.emit('itemChanged', yAxisLockedItem, {\n            username: instructorKey,\n            courseNum: foundItem.courseNum,\n            caId: foundItem.caId,\n            start: startDate.getTime(),\n            end: endDate.getTime(),\n            m_or_a: oldItem.y\n          });\n        }\n      } else {\n        yAxisLockedItem.y = oldItem.y;\n        _this.replaceItem(yAxisLockedItem);\n        _this.socket.emit('bookChanged', yAxisLockedItem, {\n          username: instructorKey,\n          modelNum: foundItem.modelNum,\n          modelName: foundItem.modelName,\n          raId: foundItem.raId,\n          start: startDate.getTime(),\n          end: endDate.getTime(),\n          quantity: foundItem.quantity\n        });\n      }\n    };\n    _this.onAddCourse = function (course) {\n      var x = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n      var y = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n      var username = arguments.length > 3 ? arguments[3] : undefined;\n      var emit = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : true;\n      var w = parseInt(course.daylength);\n      var end_x = w + x - 1;\n      var startDate = findWeekDateFromIndex(x, _this.props.currentDate, _this.props.firstDate);\n      var endDate = findWeekDateFromIndex(end_x, _this.props.currentDate, _this.props.firstDate);\n      // const instructor = this.state.instructorArray[Math.floor(y / 3)];\n\n      var start = getDayRange(_this.props.firstDate, startDate);\n      var end = getDayRange(_this.props.firstDate, endDate) + 1;\n      var m_or_a = 0;\n      if (y % 4 === 2) {\n        m_or_a = 1;\n      }\n      if (emit) {\n        _this.socket.emit('courseAdded', _objectSpread({}, course, {\n          x: x,\n          y: y - 1,\n          instructorKey: username,\n          courseNum: course.number,\n          start: startDate.getTime(),\n          end: endDate.getTime(),\n          m_or_a: m_or_a\n        }));\n      } else {\n        _this.setState({\n          // Add a new item\n          items: _this.state.items.concat({\n            start: start,\n            end: end,\n            text: course.title,\n            instructorKey: username,\n            courseNum: course.number,\n            caId: course.caId,\n            data: {\n              i: course.caId,\n              x: x,\n              y: y,\n              w: w,\n              h: 1\n            }\n          })\n        });\n      }\n    };\n    _this.onRemoveUser = function (key, y) {\n      var initialLength = _this.state.instructorArray.length;\n      _this.setState({\n        instructorArray: _.reject(_this.state.instructorArray, function (element) {\n          return element.key === key;\n        })\n      });\n    };\n    _this.onAddUser = function (user) {\n      _this.setState({\n        instructorArray: [].concat(_toConsumableArray(_this.state.instructorArray), [{\n          key: user.username,\n          name: user.firstname + \"\\n\" + user.lastname,\n          timeblocks: [],\n          vacations: []\n        }])\n      });\n    };\n    _this.resize = function () {\n      return _this.forceUpdate();\n    };\n    _this.state = {\n      // Loops through the instructor array to get all the courses associated with them\n      items: newInstructorArray.reduce(function (acc, element, index) {\n        if (element.timeblocks.length === 0 || weekInformation.length === 0) {\n          return acc;\n        }\n\n        // Create a course element for every timeblock and concatenate them into one array\n        // KEEP IN MIND. it concatenates through every course_assingment in the database. ikr?!?!?!? i didnt do this i swear\n        // btw most of this file is copy pasted code. \n        var arr = acc.concat(element.timeblocks.map(function (info) {\n          console.log('hello :D');\n          // this stuff determines the amount of days the course_assignments are from the firstDate -> jan 3, 2022\n          var startRef = getDayRange(currentDate, info.start);\n          var endRef = getDayRange(currentDate, info.end) + 1;\n          var start = getItemIndex(info.start, currentDate);\n          var end = getItemIndex(info.end, currentDate);\n          // determines how many days this event will stretch on the week view.\n          // it will give any course_assignment that isnt shown in the first week a width of 0. (makes it invisible :0)\n          var width = getCourseWidth(start, end, currentDate);\n          console.log('start width', start, width);\n          var m_or_a = info.mOrA;\n          // the data values are basically coordinates and dimensions for an RGL.\n          // i recommend looking the documentation to know what this is doing (lookup: RGL and RGL).\n          var item_x = start % 7;\n          if (start < 0) {\n            item_x = 7 + start % 7;\n          }\n          return {\n            start: startRef,\n            end: endRef,\n            text: info.name,\n            instructorKey: element.key,\n            caId: info.caId,\n            courseNum: info.courseNum,\n            data: {\n              i: info.caId,\n              x: item_x,\n              y: m_or_a,\n              w: width,\n              h: 1\n            }\n          };\n        }));\n        // this isnt not relevant to the week view but i havent touched it so idk if removing it will break the app.(it prob will)\n        return arr.concat(element.resources.map(function (info) {\n          // this stuff determines the amount of days the course_assignments are from the firstDate -> jan 3, 2022\n          var start = getDayRange(currentDate, info.resourceStart);\n          var end = getDayRange(currentDate, info.resourceEnd) + 1;\n          // determines how many days this event will stretch on the week view.\n          // it will give any course_assignment that isnt shown in the first week a width of 0. (makes it invisible :0)\n          var width = getCourseWidth(start, end, currentDate);\n          // the data values are basically coordinates and dimensions for an RGL.\n          // i recommend looking the documentation to know what this is doing (lookup: RGL and RGL).\n\n          var item_x = start % 7;\n          if (start < 0) {\n            item_x = 7 + start % 7;\n          }\n          return {\n            start: start,\n            end: end,\n            text: \"\".concat(info.quantity, \" of \").concat(info.resourceName),\n            instructorKey: element.key,\n            raId: info.raId,\n            modelNum: info.modelNum,\n            resourceName: info.resourceName,\n            quantity: info.quantity,\n            data: {\n              i: info.raId,\n              x: item_x,\n              y: 2,\n              w: width % 7,\n              h: 1\n            }\n          };\n        }));\n      }, []),\n      heightLimit: heightLimit.get,\n      weekInformation: weekInformation,\n      instructorArray: newInstructorArray,\n      currentWeekDays: currentWeekDays,\n      // i added these. again sorry. i made the same value twice and didnt realize it.\n      //makes a static value that can be read all over this file.\n      firstWeek: currentWeek,\n      currentWeek: currentWeek\n    };\n\n    //makes a static value that can be read all over this file. see next change at line 243\n    _this.firstDate = currentDate;\n    _this.socket = socket;\n    _this.heightLimit = heightLimit;\n    _this.totalWeeks = totalWeeks;\n    _this.mWeeks = currentWeekDays;\n    _this.allWeekItems = {};\n    _this.itemLayout = {};\n    _this.socket.on(\"itemChanged\", function (item) {\n      console.log(\"Item Received: \" + JSON.stringify(item));\n      _this.replaceItem(item);\n    });\n    _this.socket.on(\"courseAdded\", function (item) {\n      console.log(\"Item Received: \" + JSON.stringify(item));\n      var date = new Date(item.start);\n      var courseYear = date.getFullYear();\n      var adjustment = (courseYear - _this.props.year) * 12;\n      date.setMonth(date.getMonth() - adjustment);\n      item.start = date.getTime();\n\n      // var m_or_a = item.m_or_a\n      console.log('item', item);\n      _this.onAddCourse(item, parseInt(item.x), parseInt(item.y), item.instructorKey, false);\n    });\n    _this.socket.on(\"courseDeleted\", function (i) {\n      console.log(\"Item Received: \" + JSON.stringify(i));\n      _this.onRemoveItem(i, false);\n    });\n    _this.socket.on(\"resourceChanged\", function (item) {\n      console.log(\"Resource Received: \" + JSON.stringify(item));\n    });\n    _this.socket.on(\"bookedResourceDeleted\", function (i) {\n      console.log(\"Resource Deleted: \" + JSON.stringify(i));\n      _this.onRemoveItem(i, false);\n    });\n    return _this;\n  }\n  _createClass(LocalStorageLayout, [{\n    key: \"onRemoveItem\",\n    value: function onRemoveItem(i) {\n      var emit = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n      // Find the index of the course element in the state\n      var index = _.findIndex(this.state.items, function (element) {\n        return element.data.i === i;\n      });\n      var foundItem = this.state.items[index];\n\n      // Emit a message to all other applications that a course has been edeleted\n      if (foundItem.data.y !== 2) {\n        if (emit) {\n          this.socket.emit(\"courseDeleted\", foundItem, i);\n        }\n      } else {\n        if (emit) {\n          this.socket.emit('bookedResourceDeleted', foundItem, i);\n        }\n      }\n      // Remove the element from the state\n      this.setState({\n        items: _.reject(this.state.items, function (element) {\n          return element.data.i === i;\n        })\n      });\n    }\n  }, {\n    key: \"createElement\",\n    value: function createElement(el) {\n      var removeStyle = {\n        position: \"absolute\",\n        right: \"2px\",\n        top: 0,\n        cursor: \"pointer\",\n        padding: \"5px\",\n        color: \"black\"\n      };\n      var dsStyle = {\n        position: \"absolute\",\n        left: \"2px\",\n        bottom: 0,\n        cursor: \"pointer\",\n        padding: \"5px\",\n        color: \"black\"\n      };\n      return /*#__PURE__*/React.createElement(\"div\", {\n        key: el.data.i,\n        \"data-grid\": el.data,\n        name: el.text + \" el\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 334,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"text\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 336,\n          columnNumber: 9\n        }\n      }, el.text), ReactSession.get(\"admin\") !== undefined ? /*#__PURE__*/React.createElement(\"span\", {\n        className: \"remove\",\n        style: removeStyle,\n        onClick: this.onRemoveItem.bind(this, el.data.i),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 339,\n          columnNumber: 13\n        }\n      }, \"x\") : undefined, ReactSession.get(\"admin\") !== undefined && !('raId' in el) ? /*#__PURE__*/React.createElement(Link, {\n        to: {\n          pathname: \"/detailed-schedule\",\n          search: \"?courseNum=\" + el.courseNum\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 351,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"detailed-button\",\n        style: dsStyle,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 357,\n          columnNumber: 13\n        }\n      }, \"Details\")) : undefined);\n    }\n  }, {\n    key: \"createItemGrid\",\n    value: function createItemGrid(props, reducedMonthItems, instructorKey) {\n      var _this2 = this;\n      var ReactGridLayout = WidthProvider(RGL);\n      this.updateItems(instructorKey);\n      var callBackItemChange = function callBackItemChange(layoutWeek, oldItem, newItem) {\n        _this2.onItemChange(oldItem, newItem, instructorKey);\n      };\n      return /*#__PURE__*/React.createElement(ReactGridLayout, Object.assign({}, props, {\n        cols: 5,\n        maxRows: 3,\n        layout: this.state.layoutWeek !== undefined && instructorKey in this.state.layoutWeek ? this.state.layoutWeek[instructorKey] : [],\n        onResizeStop: callBackItemChange,\n        onDragStop: callBackItemChange\n        // onClick={callBackDoubleClick}\n        ,\n        isDraggable: ReactSession.get(\"admin\") !== undefined ? true : false,\n        isResizable: ReactSession.get(\"admin\") !== undefined ? true : false,\n        autoSize: true\n        // just added 'false'   \\/   and this  \\/ 'this.props.currentWeekDays' next change line 434\n        ,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 385,\n          columnNumber: 7\n        }\n      }), this.weekItems.map(function (el) {\n        return _this2.createElement(el, el.vid !== undefined ? true : false, _this2.props.currentWeekDays, _this2.props.newInstructorArray);\n      }));\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState) {\n      if (this.props.current_date !== prevProps.current_date) {\n        this.onLayoutChange(this.itemLayout);\n      }\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      window.addEventListener('resize', this.resize);\n    }\n  }, {\n    key: \"updateItems\",\n    value: function updateItems(instructor_key) {\n      var _this3 = this;\n      var items = [];\n      var itemCheck = {};\n      var random = this.state.items.filter(function (item) {\n        var start = item.start;\n        var end = item.end;\n        var width = getCourseWidth(start, end, _this3.props.currentDate, _this3.firstDate); //i change 'width' to be the result of this function i made. same thing on line 468\n\n        if (width === 0 || instructor_key !== item.instructorKey) {\n          return false;\n        }\n        return true;\n      });\n      random.forEach(function (element) {\n        var width = getCourseWidth(element.start, element.end, _this3.props.currentDate, _this3.firstDate); //i change 'width' to be the result of this function i made. next change on line 499\n        element.data.w = width;\n        element.data.i = element.data.i.toString();\n        element.data.maxW = _this3.props.currentWeekDays;\n        items.push(element.data);\n      });\n      this.weekItems = random;\n      this.allWeekItems[instructor_key] = random;\n      this.itemLayout[instructor_key] = items;\n      console.log('random', random);\n      return items;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n      return this.state.instructorArray.map(function (instructor, i) {\n        // let reducedMonthItems = this.weekItems\n        return /*#__PURE__*/React.createElement(React.Fragment, {\n          key: instructor.key,\n          __self: _this4,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 456,\n            columnNumber: 15\n          }\n        }, /*#__PURE__*/React.createElement(TimelineGridWeek, {\n          socket: _this4.socket,\n          heightLimit: _this4.heightLimit,\n          instructorArray: [instructor],\n          createCourse: _this4.onAddCourse,\n          onRemoveUser: _this4.onRemoveUser,\n          onAddUser: _this4.onAddUser,\n          currentDate: _this4.props.currentDate,\n          __self: _this4,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 457,\n            columnNumber: 17\n          }\n        }), /*#__PURE__*/React.createElement(\"div\", {\n          className: \"grid-item-container-week\",\n          style: {\n            top: 183 + 265 * i,\n            width: _this4.props.currentWeekDays * 178,\n            position: \"absolute\"\n          },\n          __self: _this4,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 465,\n            columnNumber: 17\n          }\n        }, _this4.createItemGrid(_this4.props, _this4.weekItems, instructor.key)));\n      });\n    }\n  }]);\n  return LocalStorageLayout;\n}(React.PureComponent); // made this new function. im sure there is a better way. \nLocalStorageLayout.defaultProps = {\n  className: \"layoutWeek\",\n  rowHeight: 75.5,\n  margin: [2, 2],\n  allowOverlap: true,\n  preventCollision: false,\n  resizeHandles: ['e'],\n  compactType: null,\n  autoSize: false\n};\nexport { LocalStorageLayout as default };\nfunction getCourseWidth(start, end, currentDate) {\n  var firstDate = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 'nothing :D';\n  // monday and friday = how many days they are from jan 3 2022. if the dates for monday and friday are in 2021 they are negative. \n  var _getMonFri = getMonFri(currentDate, firstDate),\n    _getMonFri2 = _slicedToArray(_getMonFri, 2),\n    monday = _getMonFri2[0],\n    friday = _getMonFri2[1]; // start and end values are in the same format as monday and friday.\n  // course is an incremented array of 'day values'\n  var course = _.range(start, end);\n  // week is an incremented array of 'day values'\n  var week = _.range(monday, friday + 1);\n  // intersect is an array of all the values the week and course share.\n  var intersection = course.filter(function (value) {\n    return week.includes(value);\n  });\n\n  // this counts the array. now you have a width\n  return intersection.length;\n}\n\n// this function gets how many days apart the current view's monday and friday are from jan 3 2022\nfunction getMonFri(currentDate, firstDate) {\n  var new_date = new Date(currentDate);\n  var monday = new_date.getDate();\n  var friday = monday + 4;\n  if (typeof firstDate !== 'undefined' && firstDate !== 'nothing :D') {\n    var new_monday = getDayRange(firstDate, currentDate);\n    var new_friday = getDayRange(firstDate, currentDate) + 4;\n    return [new_monday, new_friday];\n  } else {\n    return [monday, friday];\n  }\n}\n\n// gets the amount of days between two dates\nfunction getDayRange(d1, d2) {\n  return Math.round((d2.getTime() - d1.getTime()) / (1000 * 3600 * 24));\n}\nfunction getItemIndex(itemDate, currentDate) {\n  if (itemDate >= 0) {\n    return getDayRange(currentDate, itemDate);\n  } else {\n    return getDayRange(currentDate, itemDate) * -1;\n  }\n}\nfunction findWeekDateFromIndex(x, currentDate, firstDate) {\n  var x_date = new Date(currentDate);\n  x_date.setDate(x_date.getDate() + parseInt(x));\n  return x_date;\n}\nfunction findWeekDate(weekInformation, index, firstDate) {\n  return weekInformation.indexMap[index];\n}","map":{"version":3,"names":["React","_","TimelineGridWeek","ReactSession","RGL","WidthProvider","Link","Navigate","LocalStorageLayout","props","socket","heightLimit","newInstructorArray","weekInformation","totalWeeks","currentWeekDays","currentWeek","currentDate","firstDate","replaceItem","item","i","state","items","length","newLayout","slice","setState","onLayoutChange","layoutWeek","onItemChange","oldItem","newItem","instructorKey","startDate","findWeekDateFromIndex","x","endDate","w","index","findIndex","allWeekItems","element","data","toString","foundItem","yAxisLockedItem","y","emit","username","courseNum","caId","start","getTime","end","m_or_a","modelNum","modelName","raId","quantity","onAddCourse","course","parseInt","daylength","end_x","getDayRange","number","concat","text","title","h","onRemoveUser","key","initialLength","instructorArray","reject","onAddUser","user","name","firstname","lastname","timeblocks","vacations","resize","forceUpdate","reduce","acc","arr","map","info","console","log","startRef","endRef","getItemIndex","width","getCourseWidth","mOrA","item_x","resources","resourceStart","resourceEnd","resourceName","get","firstWeek","mWeeks","itemLayout","on","JSON","stringify","date","Date","courseYear","getFullYear","adjustment","year","setMonth","getMonth","onRemoveItem","el","removeStyle","position","right","top","cursor","padding","color","dsStyle","left","bottom","undefined","bind","pathname","search","reducedMonthItems","ReactGridLayout","updateItems","callBackItemChange","weekItems","createElement","vid","prevProps","prevState","current_date","window","addEventListener","instructor_key","itemCheck","random","filter","forEach","maxW","push","instructor","createItemGrid","PureComponent","defaultProps","className","rowHeight","margin","allowOverlap","preventCollision","resizeHandles","compactType","autoSize","getMonFri","monday","friday","range","week","intersection","value","includes","new_date","getDate","new_monday","new_friday","d1","d2","Math","round","itemDate","x_date","setDate","findWeekDate","indexMap"],"sources":["/home/azureuser/sotby2.0/app/src/components/NoCollision_Week.jsx"],"sourcesContent":["import React from \"react\";\nimport _ from \"lodash\";\nimport TimelineGridWeek from \"./TimelineGrid_Week\";\n// import {  } from \"@reach/router\";\nimport { ReactSession } from 'react-client-session';\nimport RGL, { WidthProvider } from \"react-grid-layout\";\nimport { Link, Navigate } from 'react-router-dom'\n\n\n\n\nexport default class LocalStorageLayout extends React.PureComponent {\n  static defaultProps = {\n    className: \"layoutWeek\",\n    rowHeight: 75.5,\n    margin: [2, 2],\n    allowOverlap: true,\n    preventCollision: false,\n    resizeHandles: ['e'],\n    compactType: null,\n    autoSize: false,\n  };\n  //###############################################################################\n  // ---------DISCLAMER: THIS WILL BE PAINFUL TO LOOK AT. IM SORRY :(.  -love matt\n  //############################################################################### \n  \n  constructor({ props, socket, heightLimit, newInstructorArray, weekInformation,  \n    totalWeeks,  currentWeekDays, currentWeek, currentDate, firstDate }) {\n    super(props);\n    \n    // let timeLineInformation = weekInformation.weekRangesArray[currentMonth];\n    this.state = {\n      // Loops through the instructor array to get all the courses associated with them\n      items: newInstructorArray.reduce(function (acc, element, index) {\n\n        if ((element.timeblocks.length === 0) || weekInformation.length === 0) {\n          \n          return acc;\n        }\n\n        // Create a course element for every timeblock and concatenate them into one array\n        // KEEP IN MIND. it concatenates through every course_assingment in the database. ikr?!?!?!? i didnt do this i swear\n        // btw most of this file is copy pasted code. \n        let arr = acc.concat(\n          element.timeblocks.map((info) => {\n            console.log('hello :D')\n            // this stuff determines the amount of days the course_assignments are from the firstDate -> jan 3, 2022\n            const startRef = getDayRange(currentDate, info.start)\n            const endRef = getDayRange(currentDate, info.end) + 1\n\n            const start = getItemIndex(info.start, currentDate)\n            const end = getItemIndex(info.end, currentDate)\n            // determines how many days this event will stretch on the week view.\n            // it will give any course_assignment that isnt shown in the first week a width of 0. (makes it invisible :0)\n            const width = getCourseWidth(start, end, currentDate);\n            console.log('start width', start, width)\n            const m_or_a = info.mOrA;\n            // the data values are basically coordinates and dimensions for an RGL.\n            // i recommend looking the documentation to know what this is doing (lookup: RGL and RGL).\n            let item_x = start % 7\n            if (start < 0) {\n              item_x = 7 + (start % 7)\n            }\n            \n            return (\n              {\n                start: startRef,\n                end: endRef,\n                text: info.name,\n                instructorKey: element.key,\n                caId: info.caId,\n                courseNum: info.courseNum,\n                data: {\n                  i: info.caId,\n                  x: item_x,\n                  y: m_or_a,\n                  w: width,\n                  h: 1,\n                }\n              }\n            )\n          })\n        );\n        // this isnt not relevant to the week view but i havent touched it so idk if removing it will break the app.(it prob will)\n        return arr.concat(\n          element.resources.map((info) => {\n            // this stuff determines the amount of days the course_assignments are from the firstDate -> jan 3, 2022\n            const start = getDayRange(currentDate, info.resourceStart)\n            const end = getDayRange(currentDate, info.resourceEnd) + 1\n            // determines how many days this event will stretch on the week view.\n            // it will give any course_assignment that isnt shown in the first week a width of 0. (makes it invisible :0)\n            const width = getCourseWidth(start, end, currentDate);\n            // the data values are basically coordinates and dimensions for an RGL.\n            // i recommend looking the documentation to know what this is doing (lookup: RGL and RGL).\n\n            let item_x = start % 7\n            if (start < 0) {\n              item_x = 7 + (start % 7)\n            }\n            return (\n              {\n                start: start,\n                end: end,\n                text: `${info.quantity} of ${info.resourceName}`,\n                instructorKey: element.key,\n                raId: info.raId,\n                modelNum: info.modelNum,\n                resourceName: info.resourceName,\n                quantity: info.quantity,\n                data: {\n                  i: info.raId,\n                  x: item_x,\n                  y: 2,\n                  w: width % 7,\n                  h: 1,\n                }\n              }\n            )\n          })\n        )\n      }, []),\n      heightLimit: heightLimit.get,\n      weekInformation: weekInformation,\n      instructorArray: newInstructorArray,\n      currentWeekDays: currentWeekDays,\n      // i added these. again sorry. i made the same value twice and didnt realize it.\n      //makes a static value that can be read all over this file.\n      firstWeek: currentWeek,\n      currentWeek: currentWeek\n\n    };\n\n    //makes a static value that can be read all over this file. see next change at line 243\n    this.firstDate = currentDate\n    \n    this.socket = socket;\n    this.heightLimit = heightLimit;\n    this.totalWeeks = totalWeeks;\n    this.mWeeks = currentWeekDays;\n\n    this.allWeekItems = {}\n\n    this.itemLayout = {};\n\n    this.socket.on(\"itemChanged\", (item) => {\n      console.log(\"Item Received: \" + JSON.stringify(item));\n\n      this.replaceItem(item);\n    });\n\n    this.socket.on(\"courseAdded\", (item) => {\n      console.log(\"Item Received: \" + JSON.stringify(item));\n      \n      var date = new Date(item.start);\n\n      var courseYear = date.getFullYear();\n\n      var adjustment = (courseYear - this.props.year) * 12;\n\n      date.setMonth(date.getMonth() - adjustment);\n\n      item.start = date.getTime();\n\n      // var m_or_a = item.m_or_a\n      console.log('item',item)\n\n      this.onAddCourse(item, parseInt(item.x), parseInt(item.y), item.instructorKey, false);\n    });\n\n    this.socket.on(\"courseDeleted\", (i) => {\n      console.log(\"Item Received: \" + JSON.stringify(i));\n\n      this.onRemoveItem(i, false);\n    });\n    this.socket.on(\"resourceChanged\", (item) => {\n      console.log(\"Resource Received: \" + JSON.stringify(item));\n    })\n    this.socket.on(\"bookedResourceDeleted\", (i) => {\n      console.log(\"Resource Deleted: \" + JSON.stringify(i));\n      this.onRemoveItem(i, false);\n    })\n  }\n\n  replaceItem = (item) => {\n\n    for (let i = 0; i < this.state.items.length; i++) {\n      if (this.state.items.i === item.i) {\n        const newLayout = this.state.items.slice();\n        newLayout[i] = item;\n        this.setState({\n          items: newLayout\n        });\n\n        break;\n      }\n    }\n  }\n\n  onLayoutChange = (layoutWeek) => {\n    this.setState({\n      layoutWeek: layoutWeek\n    });\n  }\n\n  onItemChange = (oldItem, newItem, instructorKey) => {\n    // Update the dates on the postgresql data\n\n    const startDate = findWeekDateFromIndex(newItem.x, this.props.currentDate,this.props.firstDate);\n    const endDate = findWeekDateFromIndex(newItem.w + newItem.x - 1, this.props.currentDate, this.props.firstDate);\n    \n    // HTTP request instead of sockets\n    const index = _.findIndex(this.allWeekItems[instructorKey], (element) => { return element.data.i.toString() === newItem.i });\n    const foundItem = this.allWeekItems[instructorKey][index];\n\n    // this.allWeekItems[instructorKey][index] = newItem\n\n    // Restrict movement of the course to two rows only\n    const yAxisLockedItem = newItem;\n    if (oldItem.y !== 2) {\n      if ((newItem.y < oldItem.y + 2) && (newItem.y > oldItem.y - 2)) {\n        if ((newItem.y + 1) % 3 !== 0) {\n          this.replaceItem(yAxisLockedItem);\n        } else {\n          yAxisLockedItem.y = oldItem.y;\n          this.replaceItem(yAxisLockedItem);\n        }\n      } else {\n        yAxisLockedItem.y = oldItem.y;\n        this.replaceItem(yAxisLockedItem);\n      }\n      if (yAxisLockedItem.y !== oldItem.y) {\n        this.socket.emit('itemChanged', yAxisLockedItem, { username: instructorKey, courseNum: foundItem.courseNum, caId: foundItem.caId, start: startDate.getTime(), end: endDate.getTime(), m_or_a: newItem.y });\n      } else {\n        this.socket.emit('itemChanged', yAxisLockedItem, { username: instructorKey, courseNum: foundItem.courseNum, caId: foundItem.caId, start: startDate.getTime(), end: endDate.getTime(), m_or_a: oldItem.y });\n      }\n    } else {\n      yAxisLockedItem.y = oldItem.y;\n      this.replaceItem(yAxisLockedItem);\n      this.socket.emit('bookChanged', yAxisLockedItem, { username: instructorKey, modelNum: foundItem.modelNum, modelName: foundItem.modelName, raId: foundItem.raId, start: startDate.getTime(), end: endDate.getTime(), quantity: foundItem.quantity });\n    }\n  }\n\n  onAddCourse = (course, x = 0, y = 0, username, emit = true) => {\n    const w = parseInt(course.daylength);\n    const end_x = w + x - 1\n\n\n    const startDate = findWeekDateFromIndex(x, this.props.currentDate,this.props.firstDate);\n    const endDate = findWeekDateFromIndex(end_x, this.props.currentDate, this.props.firstDate);\n    // const instructor = this.state.instructorArray[Math.floor(y / 3)];\n\n    const start = getDayRange(this.props.firstDate, startDate);\n    const end = getDayRange(this.props.firstDate, endDate) + 1;\n    let m_or_a = 0\n    if (y % 4 ===2) {\n      m_or_a = 1\n    }\n\n    if (emit) {\n\n      this.socket.emit('courseAdded', { ...course, x: x, y: y-1, instructorKey: username, courseNum: course.number, start: startDate.getTime(), end: endDate.getTime(), m_or_a: m_or_a });\n    } else {\n\n      this.setState({\n        // Add a new item\n        items: this.state.items.concat({\n          start: start,\n          end: end,\n          text: course.title,\n          instructorKey: username,\n          courseNum: course.number,\n          caId: course.caId,\n          data: {\n            i: course.caId,\n            x: x,\n            y: y,\n            w: w,\n            h: 1,\n          }\n        }),\n      });\n    }\n    \n  }\n  onRemoveItem(i, emit = true) {\n    // Find the index of the course element in the state\n    const index = _.findIndex(this.state.items, (element) => { return element.data.i === i });\n    const foundItem = this.state.items[index];\n\n    // Emit a message to all other applications that a course has been edeleted\n    if (foundItem.data.y !== 2) {\n      if (emit) {\n        this.socket.emit(\"courseDeleted\", foundItem, i);\n      }\n    } else {\n      if (emit) {\n        this.socket.emit('bookedResourceDeleted', foundItem, i);\n      }\n    }\n    // Remove the element from the state\n    this.setState({ items: _.reject(this.state.items, (element) => { return element.data.i === i }) });\n  }\n\n  onRemoveUser = (key, y) => {\n    const initialLength = this.state.instructorArray.length;\n    this.setState({ instructorArray: _.reject(this.state.instructorArray, (element) => { return element.key === key }) });\n  }\n\n  onAddUser = (user) => {\n    this.setState({ instructorArray: [...this.state.instructorArray, { key: user.username, name: user.firstname + \"\\n\" + user.lastname, timeblocks: [], vacations: [] }] });\n  }\n\n  createElement(el) {\n    \n\n    const removeStyle = {\n      position: \"absolute\",\n      right: \"2px\",\n      top: 0,\n      cursor: \"pointer\",\n      padding: \"5px\",\n      color: \"black\"\n    };\n    const dsStyle = {\n      position: \"absolute\",\n      left: \"2px\",\n      bottom: 0,\n      cursor: \"pointer\",\n      padding: \"5px\",\n      color: \"black\"\n    };\n\n    return (\n      <div key={el.data.i} data-grid={el.data}\n        name={el.text + \" el\"}>\n        <span className=\"text\">{el.text}</span>\n        {\n          ReactSession.get(\"admin\") !== undefined ?\n            <span\n              className=\"remove\"\n              style={removeStyle}\n              onClick={this.onRemoveItem.bind(this, el.data.i)}\n            >\n              x\n            </span>\n            :\n            undefined\n        }\n        {\n          ReactSession.get(\"admin\") !== undefined && !('raId' in el) ?\n          <Link\n            to={{\n              pathname: \"/detailed-schedule\",\n              search: \"?courseNum=\" + el.courseNum,\n            }}\n          >\n            <span\n              className=\"detailed-button\"\n              style={dsStyle}\n            >\n              Details\n            </span>\n          </Link>\n          :\n          undefined\n        }\n      </div>\n    );\n\n  }\n\n\n  createItemGrid(props, reducedMonthItems, instructorKey) {\n\n    const ReactGridLayout = WidthProvider(RGL);\n\n    this.updateItems(instructorKey);\n\n    const callBackItemChange = (layoutWeek, oldItem, newItem) => {\n      this.onItemChange(oldItem, newItem, instructorKey)\n    }\n    return (\n\n\n      <ReactGridLayout\n        {...props}\n        cols={5}\n        maxRows={3}\n        layout={this.state.layoutWeek !== undefined && instructorKey in this.state.layoutWeek ? this.state.layoutWeek[instructorKey] : []}\n        onResizeStop={callBackItemChange}\n        onDragStop={callBackItemChange}\n        // onClick={callBackDoubleClick}\n        isDraggable={ReactSession.get(\"admin\") !== undefined ? true : false}\n        isResizable={ReactSession.get(\"admin\") !== undefined ? true : false}\n        autoSize={true}\n                                                                // just added 'false'   \\/   and this  \\/ 'this.props.currentWeekDays' next change line 434\n      >\n        {this.weekItems.map(el => this.createElement(el, el.vid !== undefined ? true : false, this.props.currentWeekDays, this.props.newInstructorArray))} \n      </ReactGridLayout>\n    )\n  }\n\n\n  componentDidUpdate(prevProps, prevState) {\n    if (this.props.current_date !== prevProps.current_date) {\n      this.onLayoutChange(this.itemLayout);\n\n    }\n  }\n\n\n  resize = () => this.forceUpdate();\n\n  componentDidMount() {\n    window.addEventListener('resize', this.resize);\n  }\n\n  updateItems(instructor_key) {\n    \n    var items = [];\n    let itemCheck = {};\n    var random = this.state.items.filter((item) => {\n      const start = item.start;\n      const end = item.end;\n\n      const width = getCourseWidth(start, end, this.props.currentDate, this.firstDate); //i change 'width' to be the result of this function i made. same thing on line 468\n\n      if (width === 0 || instructor_key !== item.instructorKey) {\n        return false;\n      }\n\n      return true;\n    })\n\n\n\n    random.forEach(element => {\n      const width = getCourseWidth(element.start, element.end, this.props.currentDate, this.firstDate);//i change 'width' to be the result of this function i made. next change on line 499\n      element.data.w = width;\n      element.data.i = element.data.i.toString();\n      element.data.maxW = this.props.currentWeekDays;\n      items.push(element.data);\n    });\n    this.weekItems = random;\n    this.allWeekItems[instructor_key] = random\n    this.itemLayout[instructor_key] = items;\n    console.log('random', random)\n    return items;\n  }\n\n  render() {\n    return (\n      this.state.instructorArray.map((instructor, i) => {\n            // let reducedMonthItems = this.weekItems\n            return (\n              <React.Fragment key={instructor.key}>\n                <TimelineGridWeek\n                  socket={this.socket}\n                  heightLimit={this.heightLimit}\n                  instructorArray={[instructor]}\n                  createCourse={this.onAddCourse}\n                  onRemoveUser={this.onRemoveUser}\n                  onAddUser={this.onAddUser} \n                  currentDate={this.props.currentDate}/>\n                <div className=\"grid-item-container-week\" style={{top: 183 + 265 * i, width: this.props.currentWeekDays * 178, position: \"absolute\" }}>\n                  {this.createItemGrid(this.props, this.weekItems, instructor.key)}\n                </div>\n              </React.Fragment>\n            )\n        })\n\n    );\n  }\n}\n// made this new function. im sure there is a better way. \nfunction getCourseWidth(start, end, currentDate, firstDate='nothing :D') {\n  // monday and friday = how many days they are from jan 3 2022. if the dates for monday and friday are in 2021 they are negative. \n  let [monday, friday] = getMonFri(currentDate, firstDate)\n  \n  // start and end values are in the same format as monday and friday.\n  // course is an incremented array of 'day values'\n  const course = _.range(start, end)\n  // week is an incremented array of 'day values'\n  const week = _.range(monday, friday + 1)\n  // intersect is an array of all the values the week and course share.\n  const intersection = course.filter(value => week.includes(value));\n  \n  // this counts the array. now you have a width\n  return intersection.length\n}\n\n\n// this function gets how many days apart the current view's monday and friday are from jan 3 2022\nfunction getMonFri(currentDate, firstDate) {\n  const new_date = new Date(currentDate)\n  const monday = new_date.getDate()\n  const friday = monday + 4\n\n  if ((typeof firstDate !== 'undefined') && (firstDate !== 'nothing :D')){\n    let new_monday = getDayRange(firstDate, currentDate)\n    let new_friday = getDayRange(firstDate, currentDate) + 4\n\n    return [new_monday, new_friday]\n  } else {\n    return [monday, friday]\n  }\n}\n\n\n\n// gets the amount of days between two dates\nfunction getDayRange(d1, d2) {\n  \n  return Math.round((d2.getTime() - d1.getTime()) / (1000 * 3600 * 24))\n}\n\nfunction getItemIndex(itemDate, currentDate) {\n  if (itemDate >= 0) {\n    return getDayRange(currentDate, itemDate)\n  } else {\n    return getDayRange(currentDate, itemDate) * -1\n  }\n}\n\nfunction findWeekDateFromIndex(x, currentDate, firstDate) {\n  const x_date = new Date(currentDate)\n  x_date.setDate(x_date.getDate() + parseInt(x))\n  \n  return x_date\n}\n\nfunction findWeekDate(weekInformation, index, firstDate) {\n  return weekInformation.indexMap[index];\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}